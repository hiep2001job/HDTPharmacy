<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:th="http://www.thymeleaf.org"
	layout:decorate="layouts/adminLayout.html">
<head>
<meta charset="ISO-8859-1">
<title layout:fragment="title">Quản lý phân loại</title>

<!-- Page style -->
<th:block layout:fragment="pageStyle">
	<link
		th:href="@{/admin/vendors/datatables/dataTables.bootstrap.min.css}"
		rel="stylesheet" />
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet"
		href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
	<!-- page css -->
	<link th:href="@{/admin/vendors/select2/select2.css}" rel="stylesheet">
</th:block>

</head>
<body>

	<div layout:fragment="content">

		<div class="page-header">
			<h2 class="header-title">Quản lí phân loại</h2>
			<div class="header-sub-title">
				<nav class="breadcrumb breadcrumb-dash">
					<a th:href="@{/manage/dashboard}" class="breadcrumb-item"> <i
						class="anticon anticon-home m-r-5"></i>Quản lí
					</a> <a class="breadcrumb-item" href="#">Phân loại</a>
				</nav>
			</div>
		</div>
		<div class="container">
			<div class="card">
				<div class="card-body">
					<div class="row align-items-center">
						<div class="col-md-7">
							<div class="d-md-flex align-items-center">
								<div class="text-center text-sm-left ">
									<div class="avatar avatar-image"
										style="width: 150px; height: 150px">
										<img th:src="@{'/api/blob/user-images/'+${#authentication.principal.avatar}}" alt="">
									</div>
								</div>
								<div class="text-center text-sm-left m-v-15 p-l-30">
									<h2 class="m-b-5">[[${user.userFullname}]]</h2>
									<p class="text-opacity font-size-13">[[${user.allRole}]]</p>
								<!-- 	<p class="text-dark m-b-20">Frontend Developer, UI/UX
										Designer</p> -->
									<button class="btn btn-primary m-r-5" data-toggle="modal"
										data-target="#editProfileModal">
										<i class="fa-solid fa-pencil mr-2"></i>Chỉnh sửa thông tin
									</button>
								</div>
							</div>
						</div>
						<div class="col-md-5">
							<div class="row">
								<div class="d-md-block d-none border-left col-1"></div>
								<div class="col">
									<ul class="list-unstyled m-t-10">
										<li class="row">
											<p
												class="col-sm-4 col-4 font-weight-semibold text-dark m-b-5">
												<i class="m-r-10 text-primary anticon anticon-mail"></i> <span>Email:
												</span>
											</p>
											<p class="col font-weight-semibold">[[${user.email}]]</p>
										</li>
										<li class="row">
											<p
												class="col-sm-4 col-4 font-weight-semibold text-dark m-b-5">
												<i class="m-r-10 text-primary anticon anticon-phone"></i> <span>Điện thoại:
												</span>
											</p>
											<p class="col font-weight-semibold">[[${user.phone}]]</p>
										</li>
										<li class="row">
											<p
												class="col-sm-4 col-5 font-weight-semibold text-dark m-b-5">
												<i class="m-r-10 text-primary anticon anticon-compass"></i>
												<span>Địa chỉ: </span>
											</p>
											<p class="col font-weight-semibold">[[${user.address}]]</p>
										</li>
									</ul>

								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-8">
					<div class="card">
						<div class="card-body">
							<div class="accordion borderless" id="accordion-borderless">
								<div class="card">
									<div class="card-header">
										<h5 class="card-title">
											<a data-toggle="collapse" href="#collapseOneBorderless">
												<span>Cập nhật thông tin cá nhân</span>
											</a>
										</h5>
									</div>
									<div id="collapseOneBorderless" class="collapse show"
										data-parent="#accordion-borderless">
										<div class="card-body">...</div>
									</div>
								</div>
								<div class="card">
									<div class="card-header" role="tab">
										<h5 class="card-title">
											<a class="collapsed" data-toggle="collapse"
												href="#collapseTwoBorderless"> <span>Đổi mật khẩu</span>
											</a>
										</h5>
									</div>
									<div id="collapseTwoBorderless" class="collapse"
										data-parent="#accordion-borderless">
										<div class="card-body">...</div>
									</div>
								</div>
								<div class="card">
									<div class="card-header" role="tab">
										<h5 class="card-title">
											<a class="collapsed" data-toggle="collapse"
												href="#collapseThreeBorderless"> <span>Collapsible
													Group Item #3</span>
											</a>
										</h5>
									</div>
									<div id="collapseThreeBorderless" class="collapse"
										data-parent="#accordion-borderless">
										<div class="card-body">...</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- <div class="col-md-4">
					<div class="card">
						<div class="card-body">
							<h5>Connected</h5>
							<div class="m-t-30">
								<div class="d-flex align-items-center">
									<div class="avatar avatar-image">
										<img th:src="@{'/api/blob/user-images/'+${#authentication.principal.avatar}}" alt="">
									</div>
									<div class="m-l-10">
										<h5 class="m-b-0">
											<a href="" class="text-dark">Erin Gonzales</a>
										</h5>
										<span class="font-size-13 text-gray">UI/UX Designer</span>
									</div>
								</div>
							</div>
							<div class="m-t-30">
								<div class="d-flex align-items-center">
									<div class="avatar avatar-image">
										<img src="assets/images/avatars/thumb-2.jpg" alt="">
									</div>
									<div class="m-l-10">
										<h5 class="m-b-0">
											<a href="" class="text-dark">Darryl Day</a>
										</h5>
										<span class="font-size-13 text-gray">Software Engineer</span>
									</div>
								</div>
							</div>
							<div class="m-t-30">
								<div class="d-flex align-items-center">
									<div class="avatar avatar-image">
										<img src="assets/images/avatars/thumb-3.jpg" alt="">
									</div>
									<div class="m-l-10">
										<h5 class="m-b-0">
											<a href="" class="text-dark">Marshall Nichols</a>
										</h5>
										<span class="font-size-13 text-gray">Product Manager</span>
									</div>
								</div>
							</div>
							<div class="m-t-30">
								<div class="d-flex align-items-center">
									<div class="avatar avatar-image">
										<img src="assets/images/avatars/thumb-6.jpg" alt="">
									</div>
									<div class="m-l-10">
										<h5 class="m-b-0">
											<a href="" class="text-dark">Riley Newman</a>
										</h5>
										<span class="font-size-13 text-gray">Data Analyst</span>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="card">
						<div class="card-body">
							<h5>Projects</h5>
							<div class="m-t-20">
								<div class="m-b-20 p-b-20 border-bottom">
									<div class="media align-items-center m-b-15">
										<div class="avatar avatar-image">
											<img src="assets/images/others/coffee-app-thumb.jpg" alt="">
										</div>
										<div class="media-body m-l-20">
											<h5 class="m-b-0">
												<a href="" class="text-dark">Coffee Finder App</a>
											</h5>
										</div>
									</div>
									<p>It is a long established fact that a reader will be
										distracted by the readable content.</p>
									<div class="d-inline-block">
										<a class="m-r-5" data-toggle="tooltip" title="Eugene Jordan"
											href="">
											<div class="avatar avatar-image avatar-sm">
												<img src="assets/images/avatars/thumb-6.jpg" alt="">
											</div>
										</a> <a class="m-r-5" data-toggle="tooltip" title="Pamela" href="">
											<div class="avatar avatar-image avatar-sm">
												<img src="assets/images/avatars/thumb-7.jpg" alt="">
											</div>
										</a>
									</div>
									<div class="float-right">
										<span class="badge badge-pill badge-blue font-size-12 p-h-10">In
											Progress</span>
									</div>
								</div>
								<div class="m-b-20 p-b-20 border-bottom">
									<div class="media align-items-center m-b-15">
										<div class="avatar avatar-image">
											<img src="assets/images/others/weather-app-thumb.jpg" alt="">
										</div>
										<div class="media-body m-l-20">
											<h5 class="m-b-0">
												<a href="" class="text-dark">Weather App</a>
											</h5>
										</div>
									</div>
									<p>It is a long established fact that a reader will be
										distracted by the readable content.</p>
									<div class="d-inline-block">
										<a class="m-r-5" data-toggle="tooltip" title="Lillian Stone"
											href="">
											<div class="avatar avatar-image avatar-sm">
												<img src="assets/images/avatars/thumb-8.jpg" alt="">
											</div>
										</a> <a class="m-r-5" data-toggle="tooltip" title="Victor Terry"
											href="">
											<div class="avatar avatar-image avatar-sm">
												<img src="assets/images/avatars/thumb-9.jpg" alt="">
											</div>
										</a> <a class="m-r-5" data-toggle="tooltip" title="Wilma Young"
											href="">
											<div class="avatar avatar-image avatar-sm">
												<img src="assets/images/avatars/thumb-10.jpg" alt="">
											</div>
										</a>
									</div>
									<div class="float-right">
										<span class="badge badge-pill badge-cyan font-size-12 p-h-10">Completed</span>
									</div>
								</div>
								<div class="m-b-20 p-b-20 border-bottom">
									<div class="media align-items-center m-b-15">
										<div class="avatar avatar-image">
											<img src="assets/images/others/music-app-thumb.jpg" alt="">
										</div>
										<div class="media-body m-l-20">
											<h5 class="m-b-0">
												<a href="" class="text-dark">Music App</a>
											</h5>
										</div>
									</div>
									<p>Protein, iron, and calcium are some of the nutritional
										benefits associated with cheeseburgers.</p>
									<div class="d-inline-block">
										<a class="m-r-5" data-toggle="tooltip" title="Darryl Day"
											href="">
											<div class="avatar avatar-image avatar-sm">
												<img src="assets/images/avatars/thumb-2.jpg" alt="">
											</div>
										</a> <a class="m-r-5" data-toggle="tooltip"
											title="Virgil Gonzales" href="">
											<div class="avatar avatar-image avatar-sm">
												<img src="assets/images/avatars/thumb-4.jpg" alt="">
											</div>
										</a>
									</div>
									<div class="float-right">
										<span class="badge badge-pill badge-cyan font-size-12 p-h-10">Completed</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			 --></div>
		</div>

		<!--Update Category Modal -->
		<div class="modal fade" id="editProfileModal">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalCenterTitle">Cập nhật
							thông tin cá nhân</h5>
						<button type="button" class="close" data-dismiss="modal">
							<i class="anticon anticon-close"></i>
						</button>
					</div>
					<div class="modal-body">
						<form id="editProfile" th:method="POST"
							enctype="multipart/form-data"
							th:action="@{/profile}">
							<input type='hidden' name="id" th:value="${user.id}"  id="id" />
							<div class="form-group">
								<label class="font-weight-semibold" for="categoryName">Họ
									tên:</label> <input type="text" class="form-control" id="userFullName"
									th:value="${user.userFullname}" name="userFullName" placeholder="Họ tên">
							</div>
							<div class="form-group">
								<label class="font-weight-semibold" for="categoryName">Hình
									đại diện:</label>
								<div class="input-image text-center">
									<img th:if="${user.image!=null}" th:src="@{'/api/blob/user-images/'+${user.image}}"
										width="120" id="previewCreatePrimary" class="img-thumbnail">
									<img th:if="${user.image==null}" th:src="@{/admin/images/others/adobe-thumb.png}"
										width="120" id="previewCreatePrimary" class="img-thumbnail">
									<input type="file" hidden accept="image/*"
										id="createImgPrimary" name="avatar" class="image-input" />
								</div>
							</div>
							<div class="form-group">
								<label class="font-weight-semibold" for="categoryName">Điện thoại:</label> 
								<input type="text" class="form-control" id="phone"
									th:value="${user.phone}" name="phone" placeholder="Số điện thoại">
							</div>
							<div class="form-group">
								<label class="font-weight-semibold" for="categoryName">Địa chỉ:</label> 
								<input type="text" class="form-control" id="phone"
									th:value="${user.address}" name="address" placeholder="Địa chỉ">
							</div>
							
							

						</form>

					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Hủy</button>
						<button type="submit" form="editProfile" class="btn btn-primary">Lưu</button>
					</div>
				</div>
			</div>
		</div>


	</div>

	<!-- Page script -->
	<th:block layout:fragment="pageScript">
		<script th:src="@{/admin/vendors/datatables/jquery.dataTables.min.js}"></script>

		<script
			th:src="@{/admin/vendors/datatables/dataTables.bootstrap.min.js}"></script>

		<script type="text/javascript"
			th:src="@{/admin/vendors/jquery-validation/jquery.validate.min.js}"></script>


		<!-- page js -->
		<script th:src="@{/admin/vendors/select2/select2.min.js}"></script>

		<!-- Latest compiled and minified JavaScript -->
		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>

		<script>
			$('.filter-select').select2();
			//Create form validation
			$("#createCategory").validate({
				ignore : ':hidden:not(:checkbox), .ignore',
				errorElement : 'label',
				errorClass : 'is-invalid',
				validClass : 'is-valid',
				rules : {
					name : {
						required : true,
					},

				},
				messages : {
					name : {
						required : 'Trường không được bỏ trống',
					},
				}
			});
			//Fill data for edit profile
			$("table .edit").on(
					"click",
					function() {
						var id = $(this).parent().find("#id").val();
						$.ajax({
							type : 'GET',
							url : "[[@{/manage/category/}]]" + id,
							success : function(data) {
								$("#updateCategoryModal #id").val(data.id);
								$("#updateCategoryModal #categoryName").val(
										data.name);
								if (data.parentCategory != null) {
									$("#updateCategoryModal #parent").val(
											data.parentCategory.id).change();
								}
								if(data.image!=null){
									$("#updateCategoryModal #previewUpdate")
									.attr('src','[[@{/category-images/}]]'+data.image);
									$("#updateCategoryModal #oldImage").val(data.image);
								}else{
									$("#updateCategoryModal #previewUpdate")
									.attr('src','[[@{/admin/images/others/adobe-thumb.png}]]');
								}
								if (data.showOnline != null) {
									$("#updateCategoryModal #showOnline").attr('checked',data.showOnline);
								}else{
									$("#updateCategoryModal #showOnline").attr('checked',false);
								}
								$("#updateCategoryModal #level")
										.val(data.level).change();
								$("#updateCategoryModal").modal('show');
							}
						});
					});
			
			/* Delete confirmation script */
			$('#confirm-delete').on(
					'show.bs.modal',
					function(e) {
						$(this).find('#confirm-header').text(
								"Xác nhận xóa \""
										+ $(e.relatedTarget).data('label')
										+ "\"");
						$(this).find('.btn-ok').attr(
								'href',
								'/manage/category/delete/'
										+ $(e.relatedTarget).attr('value')
										+ "?page=[[${currentPage}]]");
					});
			
			/* Image Input*/
			$('.img-thumbnail').on('click',function(){
				$(this).siblings("input[type='file']").trigger('click');
			});
			$('.image-input').on('change',function(){
				 const [file]=$(this)[0].files;				
				 $(this).siblings(".img-thumbnail").attr('src',URL.createObjectURL(file)); 
			});
		</script>
	</th:block>
</body>
</html>